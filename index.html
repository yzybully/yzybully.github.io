<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YZY Music Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap"
    rel="stylesheet"
  />

  <style>
    /* Reset and basics */
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'IBM Plex Mono', monospace;
      background-color: #000;
      color: #fff;
      overflow-y: scroll;
    }
    #app {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* Sidebar */
    .sidebar {
      width: 90px;
      background-color: #111;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 40px;
      gap: 24px;
    }
    .sidebar button {
      background: none;
      border: none;
      color: #ccc;
      font-size: 14px;
      cursor: pointer;
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      letter-spacing: 0.15em;
      transition: color 0.25s;
      user-select: none;
      padding: 8px;
    }
    .sidebar button.active,
    .sidebar button:hover {
      color: #1db954; /* Spotify green highlight on hover and active */
    }

    /* Main Content */
    .main-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      background-color: #000;
      overflow-y: auto;
      padding: 20px 40px 120px 40px; /* bottom space for player bar */
      position: relative;
    }

    /* Pages */
    .page {
      display: none;
      animation: fadeIn 0.3s ease forwards;
    }
    .page.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Release lists */
    .release-list {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: flex-start;
    }

    .song-card {
      background: #111;
      border-radius: 8px;
      width: 140px;
      padding: 12px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      position: relative;
      transition: background-color 0.25s ease;
    }
    .song-card:hover {
      background-color: #222;
    }
    .song-card img {
      width: 140px;
      height: 140px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 8px;
    }
    .song-card .artist-name {
      font-size: 14px;
      color: #aaa;
      text-align: center;
      user-select: none;
      margin-bottom: 6px;
    }
    .song-card .play-release-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background-color: #1db954;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      color: #000;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      opacity: 0.9;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.2s ease;
      user-select: none;
    }
    .song-card .play-release-btn:hover {
      opacity: 1;
    }

    /* Release detail */
    #release-detail {
      position: fixed;
      inset: 0;
      background-color: rgba(0,0,0,0.9);
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
      overflow-y: auto;
      z-index: 10;
    }

    #release-detail.active {
      display: flex;
      animation: fadeIn 0.3s ease forwards;
    }

    .background-fade {
      position: fixed;
      inset: 0;
      filter: blur(20px);
      opacity: 0.3;
      z-index: -1;
      transition: background 0.4s ease;
    }

    .content-wrapper {
      max-width: 700px;
      width: 100%;
      color: white;
      text-align: center;
    }

    .release-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .back-btn {
      background: none;
      border: none;
      font-size: 28px;
      color: #1db954;
      cursor: pointer;
      user-select: none;
      padding: 0;
      line-height: 1;
      transition: color 0.2s ease;
    }
    .back-btn:hover {
      color: #1ed760;
    }

    #release-title {
      font-size: 36px;
      font-weight: 700;
      margin: 0;
      user-select: none;
    }

    #release-art-large {
      width: 300px;
      height: 300px;
      border-radius: 8px;
      object-fit: cover;
      margin: 0 auto 20px auto;
      box-shadow: 0 0 12px 2px rgba(29, 185, 84, 0.6);
      user-select: none;
    }

    #release-artist-name {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      user-select: none;
    }

    #release-type-name {
      font-size: 16px;
      color: #aaa;
      margin-bottom: 20px;
      user-select: none;
    }

    #track-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 600px;
      margin: 0 auto;
      font-size: 16px;
      user-select: none;
    }

    #track-list div {
      padding: 8px 12px;
      background: #222;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #track-list div:hover {
      background-color: #1db954;
      color: #000;
    }
    #track-list div span {
      user-select: text;
    }
    #track-list div button {
      background: none;
      border: none;
      color: inherit;
      font-size: 18px;
      cursor: pointer;
      padding: 0;
      user-select: none;
      transition: color 0.2s ease;
    }
    #track-list div button:hover {
      color: #000;
    }

    /* Player Bar */
    .player-bar {
      position: fixed;
      bottom: 0;
      left: 90px;
      right: 0;
      height: 100px;
      background-color: #181818;
      border-top: 1px solid #333;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 0 24px;
      box-sizing: border-box;
      user-select: none;
      font-size: 14px;
      color: white;
      z-index: 20;
    }

    .player-top-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 8px;
    }

    .left-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 240px;
    }
    .track-info-short {
      display: flex;
      align-items: center;
      gap: 12px;
      overflow: hidden;
    }
    .track-info-short img {
      width: 48px;
      height: 48px;
      border-radius: 4px;
      object-fit: cover;
      flex-shrink: 0;
      user-select: none;
    }
    .track-info-text {
      display: flex;
      flex-direction: column;
      overflow: hidden;
      white-space: nowrap;
    }
    .track-name {
      font-weight: 700;
      font-size: 16px;
      color: white;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .artist-name {
      font-weight: 400;
      font-size: 13px;
      color: #b3b3b3;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .play-pause-container {
      flex-shrink: 0;
      text-align: center;
    }
    .play-pause-btn {
      background: #1db954;
      border: none;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      font-size: 24px;
      color: #000;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s ease;
    }
    .play-pause-btn:hover {
      background-color: #1ed760;
    }

    .skip-back, .skip-forward {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      user-select: none;
      transition: color 0.2s ease;
    }
    .skip-back:hover, .skip-forward:hover {
      color: #1db954;
    }

    .player-bottom-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .progress-container {
      background: #404040;
      border-radius: 4px;
      cursor: pointer;
      flex-grow: 1;
      height: 6px;
      position: relative;
    }
    .progress-filled {
      background: #1db954;
      height: 100%;
      width: 0%;
      border-radius: 4px;
      transition: width 0.1s linear;
    }

    .volume-container {
      width: 120px;
    }

    .volume-slider {
      width: 100%;
      cursor: pointer;
    }

    /* Scrollbar hidden but scrollable */
    .main-content::-webkit-scrollbar {
      width: 8px;
    }
    .main-content::-webkit-scrollbar-track {
      background: #000;
    }
    .main-content::-webkit-scrollbar-thumb {
      background-color: #1db954;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div id="app">
    <nav class="sidebar">
      <button id="btn-home" class="active" aria-label="Home">HOME</button>
      <button id="btn-liked" aria-label="Liked Songs">LIKED</button>
      <button id="btn-profile" aria-label="Profile">PROFILE</button>
      <button id="btn-admin" aria-label="Admin">ADMIN</button>
    </nav>

    <main class="main-content">
      <!-- HOME PAGE -->
      <section id="home" class="page active">
        <h2>Albums</h2>
        <div id="albums" class="release-list"></div>

        <h2>EPs</h2>
        <div id="eps" class="release-list"></div>

        <h2>Singles</h2>
        <div id="singles" class="release-list"></div>
      </section>

      <!-- LIKED SONGS PAGE -->
      <section id="liked" class="page">
        <p>Liked Songs coming soon...</p>
      </section>

      <!-- PROFILE PAGE -->
      <section id="profile" class="page">
        <p>Profile page coming soon...</p>
      </section>

      <!-- ADMIN LOGIN & PANEL -->
      <section id="admin" class="page center-wrapper" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%;">
        <div id="admin-login" class="center-box" style="background:#111; padding:24px; border-radius:12px; width:300px; text-align:center;">
          <h3>Admin Login</h3>
          <input
            type="password"
            id="admin-pass"
            placeholder="Enter password"
            autocomplete="off"
            style="width:100%; padding:8px; margin:12px 0; border-radius:6px; border:none; font-family:'IBM Plex Mono', monospace;"
          />
          <button id="admin-login-btn" style="padding:10px 20px; background:#1db954; border:none; border-radius:6px; cursor:pointer; font-weight:bold; font-family:'IBM Plex Mono', monospace;">
            Login
          </button>
          <p id="admin-login-error" style="color:#f44336; display:none; margin-top:8px;">Incorrect password</p>
        </div>

        <div id="admin-panel" style="display:none; background:#111; padding:24px; border-radius:12px; width:400px; text-align:center;">
          <h3>Add New Release</h3>
          <select id="release-type" style="width:100%; padding:8px; margin:10px 0; border-radius:6px; border:none; font-family:'IBM Plex Mono', monospace;">
            <option value="albums">Album</option>
            <option value="eps">EP</option>
            <option value="singles">Single</option>
          </select>

          <input
            type="url"
            id="release-art-url"
            placeholder="Album Art URL"
            required
            style="width:100%; padding:8px; margin:10px 0; border-radius:6px; border:none; font-family:'IBM Plex Mono', monospace;"
          />
          <input
            type="text"
            id="release-artist-name"
            placeholder="Artist Name"
            required
            style="width:100%; padding:8px; margin:10px 0; border-radius:6px; border:none; font-family:'IBM Plex Mono', monospace;"
          />
          <div id="tracks-container" style="margin: 10px 0;"></div>
          <button
            id="add-track-btn"
            style="padding:8px 16px; background:#333; border:none; border-radius:6px; cursor:pointer; color:#ccc; margin-bottom:10px; font-family:'IBM Plex Mono', monospace;"
          >
            Add Track
          </button>
          <button
            id="upload-release-btn"
            style="padding:10px 20px; background:#1db954; border:none; border-radius:6px; cursor:pointer; font-weight:bold; font-family:'IBM Plex Mono', monospace;"
          >
            Upload Release
          </button>
          <button
            id="admin-logout-btn"
            style="margin-top:10px; background:#f44336; color:#fff; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-family:'IBM Plex Mono', monospace;"
          >
            Logout
          </button>
        </div>
      </section>

      <!-- RELEASE DETAIL PAGE -->
      <section id="release-detail" class="page">
        <div class="background-fade"></div>
        <div class="content-wrapper">
          <div class="release-header">
            <button class="back-btn" onclick="closeReleaseDetail()" aria-label="Back">&#8592;</button>
            <h2 id="release-title"></h2>
          </div>
          <img id="release-art-large" src="" alt="Album Art" />
          <div id="release-artist-name"></div>
          <div id="release-type-name"></div>
          <div id="track-list"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Player Bar -->
  <div class="player-bar" role="region" aria-label="Music Player Controls">
    <div class="player-top-row">
      <div class="left-controls">
        <button class="skip-back" id="prevBtn" aria-label="Previous Track">&#9664;&#9664;</button>
        <div class="track-info-short">
          <img id="player-art" src="" alt="Album Art" />
          <div class="track-info-text">
            <div id="playerTrackName" class="track-name">No Track</div>
            <div id="playerArtistName" class="artist-name">No Artist</div>
          </div>
        </div>
      </div>

      <div class="play-pause-container">
        <button id="playPauseBtn" class="play-pause-btn" aria-label="Play/Pause">&#9654;</button>
      </div>

      <button class="skip-forward" id="nextBtn" aria-label="Next Track">&#9654;&#9654;</button>
    </div>

    <div class="player-bottom-row">
      <div class="progress-container" id="progressContainer" aria-label="Track Progress">
        <div class="progress-filled" id="progressFilled"></div>
      </div>

      <div class="volume-container">
        <input
          type="range"
          id="volumeSlider"
          min="0"
          max="1"
          step="0.01"
          value="0.8"
          class="volume-slider"
          aria-label="Volume Slider"
        />
      </div>
    </div>
  </div>

  <script>
    // Elements
    const pages = [...document.querySelectorAll('.page')];
    const sidebarButtons = {
      home: document.getElementById('btn-home'),
      liked: document.getElementById('btn-liked'),
      profile: document.getElementById('btn-profile'),
      admin: document.getElementById('btn-admin')
    };

    const releasesContainers = {
      albums: document.getElementById('albums'),
      eps: document.getElementById('eps'),
      singles: document.getElementById('singles')
    };

    // Release detail elements
    const releaseDetail = document.getElementById('release-detail');
    const releaseTitle = document.getElementById('release-title');
    const releaseArtLarge = document.getElementById('release-art-large');
    const releaseArtistName = document.getElementById('release-artist-name');
    const releaseTypeName = document.getElementById('release-type-name');
    const trackList = document.getElementById('track-list');

    // Admin elements
    const adminLoginBox = document.getElementById('admin-login');
    const adminPanel = document.getElementById('admin-panel');
    const adminPassInput = document.getElementById('admin-pass');
    const adminLoginBtn = document.getElementById('admin-login-btn');
    const adminLoginError = document.getElementById('admin-login-error');
    const releaseTypeSelect = document.getElementById('release-type');
    const releaseArtInput = document.getElementById('release-art-url');
    const releaseArtistInput = document.getElementById('release-artist-name');
    const tracksContainer = document.getElementById('tracks-container');
    const addTrackBtn = document.getElementById('add-track-btn');
    const uploadReleaseBtn = document.getElementById('upload-release-btn');
    const adminLogoutBtn = document.getElementById('admin-logout-btn');

    // Player Elements
    const playerArt = document.getElementById('player-art');
    const playerTrackName = document.getElementById('playerTrackName');
    const playerArtistName = document.getElementById('playerArtistName');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const progressContainer = document.getElementById('progressContainer');
    const progressFilled = document.getElementById('progressFilled');
    const volumeSlider = document.getElementById('volumeSlider');

    // App state
    let releases = {
      albums: [],
      eps: [],
      singles: []
    };

    let currentReleaseType = null;
    let currentReleaseIndex = null;
    let currentTrackIndex = 0;
    let audio = new Audio();
    audio.volume = 0.8;

    // Load releases from localStorage
    function loadReleases() {
      const saved = localStorage.getItem('yzyReleases');
      if (saved) {
        try {
          releases = JSON.parse(saved);
        } catch {
          releases = { albums: [], eps: [], singles: [] };
        }
      }
    }

    // Save releases to localStorage
    function saveReleases() {
      localStorage.setItem('yzyReleases', JSON.stringify(releases));
    }

    // Clear all release containers
    function clearReleaseContainers() {
      Object.values(releasesContainers).forEach(container => (container.innerHTML = ''));
    }

    // Create release card with play button and art
    function createReleaseCard(release, typeKey, index) {
      const card = document.createElement('div');
      card.className = 'song-card';

      // Album art
      const art = document.createElement('img');
      art.src = release.art;
      art.alt = release.artist + ' - ' + release.type;

      // Clicking art shows release detail page
      art.addEventListener('click', () => {
        openReleaseDetail(typeKey, index);
      });

      card.appendChild(art);

      // Artist name below art
      const artistName = document.createElement('div');
      artistName.className = 'artist-name';
      artistName.textContent = release.artist;
      card.appendChild(artistName);

      // Play whole release button top right
      const playBtn = document.createElement('button');
      playBtn.className = 'play-release-btn';
      playBtn.innerHTML = '▶';
      playBtn.title = 'Play ' + release.type;
      playBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        playRelease(typeKey, index);
      });
      card.appendChild(playBtn);

      return card;
    }

    // Render all releases on home page
    function renderReleases() {
      clearReleaseContainers();

      ['albums', 'eps', 'singles'].forEach(typeKey => {
        releases[typeKey].forEach((release, index) => {
          const card = createReleaseCard(release, typeKey, index);
          releasesContainers[typeKey].appendChild(card);
        });
      });
    }

    // Open release detail page
    function openReleaseDetail(typeKey, releaseIndex) {
      currentReleaseType = typeKey;
      currentReleaseIndex = releaseIndex;
      currentTrackIndex = 0;
      const release = releases[typeKey][releaseIndex];

      releaseTitle.textContent = release.type.charAt(0).toUpperCase() + release.type.slice(1);
      releaseArtLarge.src = release.art;
      releaseArtistName.textContent = release.artist;
      releaseTypeName.textContent = release.type.charAt(0).toUpperCase() + release.type.slice(1);

      // Background fade color: album art blurred and tinted
      const bgFade = document.querySelector('.background-fade');
      bgFade.style.background = `url(${release.art}) no-repeat center center / cover`;
      bgFade.style.filter = 'blur(40px) brightness(0.2)';
      bgFade.style.transition = 'background 0.4s ease';

      // Build track list
      trackList.innerHTML = '';
      release.tracks.forEach((track, i) => {
        const trackDiv = document.createElement('div');

        const trackNameSpan = document.createElement('span');
        trackNameSpan.textContent = track.name;

        const playTrackBtn = document.createElement('button');
        playTrackBtn.innerHTML = '▶';
        playTrackBtn.title = 'Play Track';
        playTrackBtn.addEventListener('click', () => {
          currentTrackIndex = i;
          playCurrentTrack();
        });

        trackDiv.appendChild(trackNameSpan);
        trackDiv.appendChild(playTrackBtn);
        trackList.appendChild(trackDiv);
      });

      switchPage('release-detail');
    }

    function closeReleaseDetail() {
      switchPage('home');
      audio.pause();
      resetPlayerInfo();
    }

    // Switch page helper
    function switchPage(pageId) {
      pages.forEach(page => {
        if (page.id === pageId) {
          page.classList.add('active');
        } else {
          page.classList.remove('active');
        }
      });
      clearActiveSidebar(pageId);
    }

    // Clear active sidebar button and highlight current
    function clearActiveSidebar(activePageId) {
      Object.entries(sidebarButtons).forEach(([key, btn]) => {
        if (key === activePageId) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
    }

    // Player Controls

    function playCurrentTrack() {
      if (currentReleaseType === null || currentReleaseIndex === null) return;
      const release = releases[currentReleaseType][currentReleaseIndex];
      if (!release) return;
      const track = release.tracks[currentTrackIndex];
      if (!track) return;

      audio.src = track.url;
      audio.play();

      playerArt.src = release.art;
      playerTrackName.textContent = track.name;
      playerArtistName.textContent = release.artist;
      playPauseBtn.innerHTML = '⏸';
    }

    function playRelease(typeKey, releaseIndex) {
      currentReleaseType = typeKey;
      currentReleaseIndex = releaseIndex;
      currentTrackIndex = 0;
      playCurrentTrack();
      switchPage('home'); // Stay on home, or you can open detail if you want
    }

    playPauseBtn.addEventListener('click', () => {
      if (audio.paused) {
        audio.play();
        playPauseBtn.innerHTML = '⏸';
      } else {
        audio.pause();
        playPauseBtn.innerHTML = '▶';
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentReleaseType === null || currentReleaseIndex === null) return;
      const release = releases[currentReleaseType][currentReleaseIndex];
      if (!release) return;
      currentTrackIndex = (currentTrackIndex + 1) % release.tracks.length;
      playCurrentTrack();
    });

    prevBtn.addEventListener('click', () => {
      if (currentReleaseType === null || currentReleaseIndex === null) return;
      const release = releases[currentReleaseType][currentReleaseIndex];
      if (!release) return;
      currentTrackIndex = (currentTrackIndex - 1 + release.tracks.length) % release.tracks.length;
      playCurrentTrack();
    });

    audio.addEventListener('ended', () => {
      nextBtn.click();
    });

    audio.addEventListener('timeupdate', () => {
      if (audio.duration) {
        const percent = (audio.currentTime / audio.duration) * 100;
        progressFilled.style.width = percent + '%';
      }
    });

    progressContainer.addEventListener('click', e => {
      const width = progressContainer.clientWidth;
      const clickX = e.offsetX;
      if (!audio.duration) return;
      audio.currentTime = (clickX / width) * audio.duration;
    });

    volumeSlider.addEventListener('input', () => {
      audio.volume = volumeSlider.value;
    });

    function resetPlayerInfo() {
      playerArt.src = '';
      playerTrackName.textContent = 'No Track';
      playerArtistName.textContent = 'No Artist';
      playPauseBtn.innerHTML = '▶';
      progressFilled.style.width = '0%';
    }

    // Admin login
    const passwordHash = 'r9fNZyDjozYxsfHGHrkQfsBj/IFHC8D3y4dEBvKuhrA8=';

    async function hashPassword(pass) {
      const encoder = new TextEncoder();
      const data = encoder.encode(pass);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return btoa(String.fromCharCode(...hashArray));
    }

    adminLoginBtn.addEventListener('click', async () => {
      const entered = adminPassInput.value.trim();
      if (!entered) return;

      const enteredHash = await hashPassword(entered);
      if (enteredHash === passwordHash) {
        adminLoginError.style.display = 'none';
        adminLoginBox.style.display = 'none';
        adminPanel.style.display = 'block';
        adminPassInput.value = '';
        switchPage('admin');
      } else {
        adminLoginError.style.display = 'block';
      }
    });

    adminLogoutBtn.addEventListener('click', () => {
      adminLoginBox.style.display = 'block';
      adminPanel.style.display = 'none';
      switchPage('home');
    });

    // Admin add tracks UI
    function createTrackInput(index) {
      const div = document.createElement('div');
      div.style.marginBottom = '8px';
      div.style.display = 'flex';
      div.style.gap = '8px';

      const nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.placeholder = 'Track name';
      nameInput.required = true;
      nameInput.style.flex = '2';
      nameInput.style.padding = '6px';
      nameInput.style.borderRadius = '6px';
      nameInput.style.border = 'none';
      nameInput.style.fontFamily = "'IBM Plex Mono', monospace";

      const urlInput = document.createElement('input');
      urlInput.type = 'url';
      urlInput.placeholder = 'MP3 URL';
      urlInput.required = true;
      urlInput.style.flex = '3';
      urlInput.style.padding = '6px';
      urlInput.style.borderRadius = '6px';
      urlInput.style.border = 'none';
      urlInput.style.fontFamily = "'IBM Plex Mono', monospace";

      div.appendChild(nameInput);
      div.appendChild(urlInput);

      return { container: div, nameInput, urlInput };
    }

    function clearTracksContainer() {
      tracksContainer.innerHTML = '';
    }

    let trackInputs = [];

    addTrackBtn.addEventListener('click', () => {
      const { container, nameInput, urlInput } = createTrackInput(trackInputs.length);
      tracksContainer.appendChild(container);
      trackInputs.push({ container, nameInput, urlInput });
    });

    // Add first track input on page load
    addTrackBtn.click();

    // Upload release handler
    uploadReleaseBtn.addEventListener('click', () => {
      const type = releaseTypeSelect.value;
      const artUrl = releaseArtInput.value.trim();
      const artistName = releaseArtistInput.value.trim();

      if (!artUrl || !artistName) {
        alert('Please fill in Album Art URL and Artist Name');
        return;
      }

      const tracks = [];
      for (const ti of trackInputs) {
        const trackName = ti.nameInput.value.trim();
        const trackUrl = ti.urlInput.value.trim();

        if (!trackName || !trackUrl) {
          alert('Please fill in all track names and MP3 URLs');
          return;
        }

        tracks.push({ name: trackName, url: trackUrl });
      }

      if (tracks.length === 0) {
        alert('Please add at least one track');
        return;
      }

      // Add to releases
      releases[type].push({
        art: artUrl,
        artist: artistName,
        tracks: tracks,
        type: type.slice(0, -1), // album/ep/single
      });

      saveReleases();
      renderReleases();

      // Clear inputs and hide admin panel
      releaseArtInput.value = '';
      releaseArtistInput.value = '';
      clearTracksContainer();
      trackInputs = [];
      addTrackBtn.click();
      adminPanel.style.display = 'none';
      adminLoginBox.style.display = 'block';
      switchPage('home');
    });

    // Sidebar nav
    Object.entries(sidebarButtons).forEach(([key, btn]) => {
      btn.addEventListener('click', () => {
        if (key === 'admin') {
          if (adminPanel.style.display === 'block') {
            switchPage('admin');
          } else {
            switchPage('admin');
          }
        } else {
          switchPage(key);
        }
      });
    });

    // Initialize
    loadReleases();
    renderReleases();
    resetPlayerInfo();

    // Helpers
    function playRelease(typeKey, index) {
      currentReleaseType = typeKey;
      currentReleaseIndex = index;
      currentTrackIndex = 0;
      playCurrentTrack();
    }
  </script>
</body>
</html>
